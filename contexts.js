console.log("start");var gFirstHash, gEndHash;var WordList = [];var ChooseTags;var FilterStatus;chrome.extension.onRequest.addListener(  function(request, sender, sendResponse) {    if (request.name == "KeyWord") {        sendResponse({name: "true"});        WordList = request.word;        console.log("context1.js WordList:"+WordList);        ActionForUp();        }    else if (request.name == "ChooseTag") {         sendResponse({name: "true"});        ChooseTags = request.word;        console.log("context1.js ChooseTags:"+ChooseTags);        HiddenDiv();    }else if(request.name == "FilterStatus"){        sendResponse({name: "true"});        FilterStatus = request.word;        console.log("context1.js FilterStatus:"+FilterStatus);        ActionForUp();    }else      sendResponse({}); // snub them.      });    var HiddenByWord = function(WordList){    //屏蔽关键字新鲜事    if(FilterStatus != "open") return;    var tags = document.getElementsByTagName("article");    for(i in tags){        tag = tags[i];        //var text = tag.getElementsByTagName("h3").item().innerHTML;        //console.log(text);        if(tag && tag.className){            if(tag.className.indexOf("a-feed") > -1){                var text = tag.getElementsByTagName("h3").item().innerHTML;                for(j in WordList){                    if(WordList[j] && WordList[j] != " " && text.indexOf(WordList[j]) > -1)                        tag.parentNode.removeChild(tag);                }            }        }    }}function $(id){    return document.getElementById(id);}function $class(cla){    return document.getElementsByClassName(cla);}function removeId(id){    var node = $(id);    if(!node) return;    node.parentNode.removeChild(node);}function removeClass(c){    var node = $class(c);    if(!node || !node[0]) return;    node[0].parentNode.removeChild(node[0]);}function hiddenClass(c){    var node = $class(c);    if(!node || !node[0]) return;    node[0].style.visibility ="hidden";}function showClass(c){    var node = $class(c);    if(!node || !node[0]) return;    node[0].style.visibility ="";}function hiddenId(c){    var node = $(c);    if(!node) return;    node.style.visibility ="hidden";}function showId(c){    var node = $(c);    if(!node) return;    node.style.visibility ="";}var HiddenDiv =function(){    //屏蔽多余的模块    if(!ChooseTags) ChooseTags = " ";    //console.log("start hidden:"+ChooseTags);    /*    if(ChooseTags.indexOf("ad") > -1){        hiddenId("ad100000000100");        hiddenId("ad100000000101");        hiddenId("ad1000000060");        hiddenId("ad1000000065");    }else{        showId("ad100000000100");        showId("ad100000000101");        showId("ad1000000060");        showId("ad1000000065");    }    */    if(ChooseTags.indexOf("come") > -1){        hiddenId("footPrint")    }else{        showId("footPrint");    }    if(ChooseTags.indexOf("FriSe") > -1){        hiddenClass("ready-to-fix");        hiddenId("recommendFriends");        hiddenClass("side-item pymk pymk-home");    }else{        showClass("ready-to-fix");        showId("recommendFriends");        hiddenClass("side-item pymk pymk-home");    }    if(ChooseTags.indexOf("LastY") > -1){        hiddenId("friendPhotoCon");        hiddenId("friendPhoto");    }else{        showId("friendPhotoCon");        showId("friendPhoto");    }    if(ChooseTags.indexOf("topic") > -1){        hiddenClass("today-topic");    }else{        showClass("today-topic");    }    if(ChooseTags.indexOf("music") > -1){        hiddenId("webpager-miniradio");    }else{        showId("webpager-miniradio");    }    if(ChooseTags.indexOf("left") > -1){        hiddenId("sidebar");    }else{        showId("sidebar");    }    if(ChooseTags.indexOf("search") > -1){        hiddenId("navSearch_new");    }else{        showId("navSearch_new");    }    if(ChooseTags.indexOf("logo") > -1){        hiddenId("logo2");    }else{        showId("logo2");    }    if(ChooseTags.indexOf("note") > -1){        hiddenId("navMessage");    }else{        showId("navMessage");    }    if(ChooseTags.indexOf("comst") > -1){        hiddenId("accountMenu");    }else{        showId("accountMenu");    }    if(ChooseTags.indexOf("La1") > -1){        hiddenId("profileMenuActive");    }else{        showId("profileMenuActive");    }     if(ChooseTags.indexOf("La2") > -1){        hiddenId("friendMenuActive");        hiddenId("showAppMenu");    }else{        showId("friendMenuActive");        showId("showAppMenu");    }          if(ChooseTags.indexOf("selfmsg") > -1){        hiddenClass("user-info clearfix");    }else{        showClass("user-info clearfix");    }     if(ChooseTags.indexOf("head") > -1){        hiddenClass("clearfix tabview_header");    }else{        showClass("clearfix tabview_header");    }             if(ChooseTags == " ") ChooseTags = "";}function HiddenDiv2(){    if(ChooseTags && ChooseTags.indexOf("FriList") > -1){        hiddenId("friends-panel");    }else{        showId("friends-panel");    }          //去掉自动播放    /*    var object = document.getElementsByTagName("object");    var obj_len = object.length;    for(var i = 0; i < obj_len; i++){        var params = object[i].children;        for(x in params){            if(params[x].name == "FlashVars" && params[x].value == "") {                object[i].parentNode.removeChild(object[i]);            }        }    }    */                hiddenId("toolBackTo");    hiddenClass("star-new");    hiddenId("footer");    hiddenClass("side-item sales-poll");    hiddenClass("r-ad");    hiddenId("topic-hot-el");    hiddenId("rightapp_side_div");    hiddenId("xb-cronerspread");        hiddenId("notice_system");    hiddenId("ad1000000060");    removeId("ad100000000100");    removeId("ad100000000101");    removeId("ad1000000060");    removeId("ad1000000065");    hiddenId("dressupHomeBtn");    hiddenId("homeBirthdayPart");    var sidebar2 = $("sidebar2")    if(sidebar2){        sidebar2 = sidebar2.children;        for(i in sidebar2){            if(sidebar2[i].innerText && sidebar2[i].innerText.indexOf("\u7ad9\u5185\u529f\u80fd") > -1)            sidebar2[i].style.visibility ="hidden";        }    }}function hasClass(obj, cls) {      return obj.className.match(new RegExp('(\\s|^)' + cls + '(\\s|$)'));  }  function addClass(obj, cls) {      if (!this.hasClass(obj, cls)) {        if(obj.className.length == 0){            obj.className = cls;          }else{            obj.className += " " + cls;          }    }}    function removeClass(obj, cls) {      if (hasClass(obj, cls)) {          var reg = new RegExp('(\\s|^)' + cls + '(\\s|$)');          obj.className = obj.className.replace(reg, ' ');      }  }  var HashString = function(str){    str = str.toLowerCase();    var hash = 1315423911,i,ch;    for (i = str.length - 1; i >= 0; i--) {        ch = str.charCodeAt(i);        hash ^= ((hash << 5) + ch + (hash >> 2));    }    return  (hash & 0x7FFFFFFF);}var ActionForUp = function(){    console.log("gFirstHash:"+gFirstHash);    console.log("gEndHash:"+gEndHash);    console.log("FilterStatus:"+FilterStatus);    if(WordList)        HiddenByWord(WordList);}var chknew = function(){    var tags = document.getElementsByTagName("article");    var FirstTag, EndTag;    var nFirstHash, nEndHash;    for(i in tags){        tag = tags[i];        if(tag && tag.className){            if(tag.className.indexOf("a-feed") > -1){                FirstTag = tag;                break;            }        }    }    var len = tags.length;    for(i in tags){        tag = tags[len-i-1];        if(tag && tag.className){            if(tag.className.indexOf("a-feed") > -1){                EndTag = tag;                break;            }        }    }    if(!FirstTag || !EndTag) return;    nFirstHash = HashString(FirstTag.innerText);    nEndHash = HashString(EndTag.innerText);    if(gFirstHash != nFirstHash || gEndHash != nEndHash)    {        gFirstHash = nFirstHash;        gEndHash = nEndHash;        ActionForUp();    }}setInterval("chknew()", 1000);setInterval("HiddenDiv2()", 500);setInterval("HiddenDiv()", 2000);